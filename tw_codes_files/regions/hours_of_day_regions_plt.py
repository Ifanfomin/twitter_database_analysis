import sqlite3
from matplotlib import pyplot as plt

conn = sqlite3.connect(r'D:\projects\dbase\twitterdb\tw_db_5mln\twitter_5mln.db')
cur = conn.cursor()

colors = ['g', 'r', 'c', 'm', 'y', 'orange', 'violet']

regions = ['Japan', 'China', 'UK', 'RU', 'UA', 'FR', 'DE'] # , 'RU', 'USA', 'UA', 'Japan', 'China'

norm_regions = ['Япония (Japan)', 'Китай (China)', 'Соед. Кор. (UK)', 'Россия (RU)', 'Украина (UA)', 'Франция (FR)', 'Германия (DE)']

for reg in regions:
    hours = []
    creatings = []
    hour_creats = 0
    for i in range(10):
        query = 'SELECT count() FROM accounts WHERE created_at LIKE "%0' + str(i) + ':%:%" AND location LIKE "%' + reg +'%"'
        cur.execute(query)
        hour_creats = cur.fetchone()[0]
        hours.append(i)
        creatings.append(hour_creats)
        print(i, hour_creats)
    for i in range(10, 24):
        query = 'SELECT count() FROM accounts WHERE created_at LIKE "%' + str(i) + ':%:%" AND location LIKE "%' + reg + '%"'
        cur.execute(query)
        hour_creats = cur.fetchone()[0]
        hours.append(i)
        creatings.append(hour_creats)
        print(i, hour_creats)

    print(hours)
    print(creatings)

    summ_registrations = sum(creatings)

    for i in range(len(creatings)):
        creatings[i] = (creatings[i] / summ_registrations) * 100

    print(hours)
    print(creatings)

    print(reg)

    plt.plot(hours, creatings, color=colors[regions.index(reg)], marker='o', linestyle='solid', label=norm_regions[regions.index(reg)])
plt.xlabel('час')
plt.ylabel('создано аккаунтов проц')
plt.legend()
plt.show()
# plt.savefig('accounts_creating_hours.png')

# C:\Users\79275\AppData\Local\Microsoft\WindowsApps\python3.9.exe D:/projects/git_pr/twitter_database_analysis/tw_codes_files/regions/hours_of_day_regions_plt.py
# 0 120
# 1 150
# 2 163
# 3 151
# 4 140
# 5 144
# 6 140
# 7 122
# 8 129
# 9 119
# 10 128
# 11 138
# 12 147
# 13 181
# 14 168
# 15 182
# 16 152
# 17 103
# 18 111
# 19 91
# 20 85
# 21 51
# 22 70
# 23 91
# [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
# [120, 150, 163, 151, 140, 144, 140, 122, 129, 119, 128, 138, 147, 181, 168, 182, 152, 103, 111, 91, 85, 51, 70, 91]
# [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
# [3.901170351105332, 4.876462938881664, 5.2990897269180754, 4.908972691807542, 4.551365409622886, 4.681404421326398, 4.551365409622886, 3.966189856957087, 4.193758127438231, 3.868660598179454, 4.161248374512354, 4.486345903771132, 4.778933680104031, 5.884265279583875, 5.461638491547465, 5.9167750325097535, 4.9414824447334205, 3.3485045513654095, 3.6085825747724316, 2.9583875162548767, 2.7633289986996097, 1.6579973992197659, 2.275682704811443, 2.9583875162548767]
# Japan
# 0 359
# 1 561
# 2 639
# 3 843
# 4 742
# 5 789
# 6 808
# 7 820
# 8 814
# 9 781
# 10 699
# 11 712
# 12 775
# 13 862
# 14 855
# 15 779
# 16 655
# 17 457
# 18 291
# 19 199
# 20 138
# 21 102
# 22 101
# 23 180
# [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
# [359, 561, 639, 843, 742, 789, 808, 820, 814, 781, 699, 712, 775, 862, 855, 779, 655, 457, 291, 199, 138, 102, 101, 180]
# [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
# [2.5714490366019627, 4.018336795358499, 4.577036028937755, 6.0382494090681185, 5.314805529689851, 5.651457631974787, 5.787551035026144, 5.873504763269106, 5.830527899147626, 5.594155146479478, 5.006804670152568, 5.099921209082444, 5.551178282357997, 6.174342812119476, 6.124203137311081, 5.5798295251056516, 4.691640999928372, 3.2734044839194896, 2.0843779098918414, 1.4253993266957954, 0.9884678747940692, 0.7306066900651816, 0.723443879378268, 1.2893059236444382]
# China
# 0 467
# 1 401
# 2 360
# 3 335
# 4 280
# 5 282
# 6 349
# 7 452
# 8 560
# 9 672
# 10 744
# 11 778
# 12 866
# 13 807
# 14 859
# 15 877
# 16 868
# 17 890
# 18 902
# 19 942
# 20 990
# 21 929
# 22 789
# 23 647
# [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
# [467, 401, 360, 335, 280, 282, 349, 452, 560, 672, 744, 778, 866, 807, 859, 877, 868, 890, 902, 942, 990, 929, 789, 647]
# [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
# [2.9103826498815906, 2.499065187585691, 2.2435497943412686, 2.087747725289792, 1.7449831733765426, 1.7574473389006604, 2.174996883958619, 2.8169014084507045, 3.4899663467530853, 4.187959616103702, 4.636669574971956, 4.848560388881965, 5.396983671943163, 5.029290788981678, 5.353359092608749, 5.4655365823258135, 5.409447837467281, 5.546553658232582, 5.6213386513772905, 5.870621961859653, 6.169761934438489, 5.789604885952886, 4.9171132992646145, 4.0321575470522255]
# UK
# 0 1022
# 1 1054
# 2 1028
# 3 986
# 4 985
# 5 884
# 6 924
# 7 924
# 8 1038
# 9 1038
# 10 1109
# 11 1158
# 12 1329
# 13 1429
# 14 1514
# 15 1601
# 16 1646
# 17 1760
# 18 1662
# 19 1610
# 20 1420
# 21 1298
# 22 1187
# 23 1108
# [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
# [1022, 1054, 1028, 986, 985, 884, 924, 924, 1038, 1038, 1109, 1158, 1329, 1429, 1514, 1601, 1646, 1760, 1662, 1610, 1420, 1298, 1187, 1108]
# [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
# [3.439456148616814, 3.5471494918220365, 3.4596486504677926, 3.318301137510938, 3.3149357205357743, 2.9750286060442885, 3.1096452850508176, 3.1096452850508176, 3.493302820219425, 3.493302820219425, 3.7322474254560136, 3.897152857239012, 4.472639159991923, 4.809180857508245, 5.095241300397119, 5.388032577236319, 5.5394763411186645, 5.923133876287272, 5.593323012721276, 5.418321330012789, 4.778892104731777, 4.3683112337618635, 3.994749949518745, 3.7288820084808507]
# RU
# 0 1692
# 1 1787
# 2 1815
# 3 1564
# 4 1443
# 5 1182
# 6 994
# 7 847
# 8 755
# 9 682
# 10 734
# 11 834
# 12 1025
# 13 1199
# 14 1487
# 15 1637
# 16 1739
# 17 1832
# 18 1716
# 19 1764
# 20 1632
# 21 1697
# 22 1660
# 23 1627
# [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
# [1692, 1787, 1815, 1564, 1443, 1182, 994, 847, 755, 682, 734, 834, 1025, 1199, 1487, 1637, 1739, 1832, 1716, 1764, 1632, 1697, 1660, 1627]
# [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
# [5.074376199616123, 5.3592850287907865, 5.443258157389636, 4.690499040307102, 4.327615163147793, 3.5448656429942416, 2.9810460652591173, 2.5401871401151634, 2.264275431861804, 2.045345489443378, 2.201295585412668, 2.501199616122841, 3.0740163147792705, 3.5958493282149715, 4.459572936660269, 4.909428982725528, 5.215331094049904, 5.494241842610364, 5.1463531669865645, 5.290307101727447, 4.894433781190019, 5.089371401151632, 4.978406909788868, 4.8794385796545106]
# UA
# 0 1117
# 1 1001
# 2 961
# 3 917
# 4 945
# 5 956
# 6 1003
# 7 1072
# 8 1160
# 9 1306
# 10 1230
# 11 1244
# 12 1425
# 13 1461
# 14 1622
# 15 1672
# 16 1798
# 17 2012
# 18 1982
# 19 2063
# 20 2124
# 21 1899
# 22 1584
# 23 1310
# [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
# [1117, 1001, 961, 917, 945, 956, 1003, 1072, 1160, 1306, 1230, 1244, 1425, 1461, 1622, 1672, 1798, 2012, 1982, 2063, 2124, 1899, 1584, 1310]
# [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
# [3.298488069926766, 2.955941412709662, 2.8378218757382467, 2.7078903850696907, 2.790574060949681, 2.82305693361682, 2.961847389558233, 3.1656035908339235, 3.425466572171037, 3.856602882116702, 3.6321757618710135, 3.673517599811009, 4.208008504606662, 4.314316087880936, 4.789747224190881, 4.93739664540515, 5.309473186865107, 5.9414127096621785, 5.852823056933617, 6.092015119300733, 6.27214741318214, 5.6077250177179305, 4.677533664068037, 3.8684148358138435]
# FR
# 0 4075
# 1 4064
# 2 4001
# 3 3773
# 4 3379
# 5 2761
# 6 2501
# 7 2408
# 8 2358
# 9 2543
# 10 2635
# 11 2934
# 12 3377
# 13 3876
# 14 4411
# 15 4797
# 16 4907
# 17 5209
# 18 5188
# 19 5203
# 20 5102
# 21 4842
# 22 4536
# 23 4350
# [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
# [4075, 4064, 4001, 3773, 3379, 2761, 2501, 2408, 2358, 2543, 2635, 2934, 3377, 3876, 4411, 4797, 4907, 5209, 5188, 5203, 5102, 4842, 4536, 4350]
# [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
# [4.370910651077979, 4.359111873860345, 4.291537058886624, 4.046980585648397, 3.6243698380349674, 2.961493081626086, 2.6826128928456505, 2.58285959455111, 2.529228789016411, 2.7276627694947977, 2.826343451678644, 3.147055668776145, 3.6222246058135794, 4.157460045049877, 4.731309664271157, 5.145339482999034, 5.263327255175373, 5.587257320604955, 5.564732382280382, 5.580821623940792, 5.472487396760699, 5.193607207980263, 4.865386678107905, 4.665880081518824]
# DE
